
<div class="Root__now-playing-bar">
    <footer class="now-playing-bar-container">
        <div class="now-playing-bar">
            <div class="now-playing-bar__left">
                <div class="now-playing">
                    <div class="" aria-label="" style="border: none;" onclick="toggle('slider')">
                        <div id="albumArt">
                            <img src="~/Images/TM-SWL008.jpg" aria-hidden="true" style="width: 56px; height: 56px;">
                        </div>
                    </div>
                    <div class="track-info">
                        <div class="track-info__name" id="songName">
                            <h6>Song Name</h6>
                        </div>
                        <div class="track-info__artists" id="songArtist">
                            <h6>Song Artist</h6>
                        </div>
                    </div>
                </div>
            </div>
            <div class="now-playing-bar__center">
                <audio id="myAudio" src="~/Audio/Risk.mp3" preload="metadata" volume="0.2"></audio>
                <div class="player-controls">
                    <div class="player-controls__buttons">
                        @*<button class="control-button" id="random-btn" title="Enable shuffle"> <i class="fas fa-random"></i></button>*@
                        <button class="control-button" id="backward-btn" onclick="prev()" title="Previous"><i class="fas fa-step-backward"></i></button>
                        <button class="control-button" id="play-btn" onclick="playPause()" title="Play" aria-hidden="true"><i class="far fa-play-circle fa-2x" aria-hidden="true"></i></button>
                        <button class="control-button" id="forward-btn" onclick="next()" title="Next"><i class="fas fa-step-forward"></i></button>
                        @*<button class="control-button" id="repeat-btn" title="Enable repeat"><i class="fas fa-redo-alt"></i></button>*@
                    </div>
                    <div id="playbackTime">00:00 / 00:00</div>
                    <div id="playbackBar">
                        <div id="progressBar"></div>
                        <div id="movingBar"></div>
                    </div>
                </div>
            </div>
            <div class="now-playing-bar__right">
                <div class="volume-bar">
                    <button class="control-button" id="volume" onclick="toggleVolume()" aria-label="Mute"><i class="fas fa-volume-up" id="volumeIcon"></i></button>
                </div>
            </div>
        </div>
    </footer>
</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script>
    console.clear();
    // Play Icon Switcher
    //$("#play-btn").click(function (e) {
    //    e.preventDefault();
    //    $(this).find("i").toggleClass("fa-play-circle fa-pause-circle");
    //});

    const songs = ["Audio/Risk.mp3", "Audio/01%20Bonita.mp3", "Audio/Zikomo%20-%20Stussy%20x%20Soulection%20Compilation%20-%2001%20Champion%20Riddim.mp3"];
    const songNames = ["Risk", "Bonita", "Champion Riddim"];
    const artists = ["Tom Misch", "oriJanus", "Zikomo"];
    const posters = ["Images/TM-SWL008.jpg", "Images/OJ-SWL013.jpg", "Images/SXSC.jpg"];

    const songNameElement = document.getElementById("songName");
    const songArtistElement = document.getElementById("songArtist");
    const progressBarElement = document.getElementById("progressBar");
    const playbackTimeElement = document.getElementById("playbackTime");

    var player = new Audio();
    var currentSong = 0;

    $(document).ready(function () {
        player.src = songs[currentSong];
        songNameElement.textContent = songNames[currentSong];
        songArtistElement.textContent = artists[currentSong];
    });

    function playTrack(trackGUID) {
        player.pause();
        player.currentTime = 0;
        player.src = 'Audio/' + trackGUID + '.mp3';
        player.play();
        $("#play-btn i").removeClass("fa-play-circle").addClass("fa-pause-circle");
        $.get("/GetNowPlayingTrackData?trackGUID=" + trackGUID, null, function (data) {
            songNameElement.textContent = data.TrackName;
            songArtistElement.textContent = data.ArtistName;
            $("#albumArt img").attr("src", data.AlbumArt);
        });
    }

    function playPause() {
        if (player.paused) {
            player.play();
            $("#play-btn i").removeClass("fa-play-circle").addClass("fa-pause-circle");
        }
        else {
            player.pause();
            $("#play-btn i").removeClass("fa-pause-circle").addClass("fa-play-circle")
        }
    }

    player.addEventListener('timeupdate', function () {
        var position = player.currentTime / player.duration;
        progressBarElement.style.width = position * 100 + '%';
        displayTrackTime();
        if (player.ended) {
            next();
        }
    });

    function displayTrackTime() {
        var stringCurrentTime = getFormatedTime(player.currentTime);
        var stringTotalTime = getFormatedTime(player.duration);
        playbackTimeElement.textContent = stringCurrentTime + ' / ' + stringTotalTime;
    }

    function getFormatedTime(seconds) {
        if (seconds && !isNaN(seconds)) {
            seconds = Math.round(seconds);
            var min = Math.floor(seconds / 60);
            var sec = seconds % 60;
            min = (min < 10) ? "0" + min : min;
            sec = (sec < 10) ? "0" + sec : sec;
            return min + ":" + sec;
        }
        else {
            return "0:00"
        }
    }

    function next() {
        currentSong++;
        if (currentSong > songs.length-1) {
            currentSong = 0;
        }
        playSong();
        $("#play-btn i").removeClass("fa-play-circle").addClass("fa-pause-circle");
        $("#albumArt img").attr("src", posters[currentSong]);
    }

    function prev() {
        currentSong--;
        if (currentSong < 0) {
            currentSong = songs.lenth-1;
        }
        playSong();
        $("#play-btn i").removeClass("fa-play-circle").addClass("fa-pause-circle");
        $("albumArt img").attr("src", posters[currentSong]);
    }


    function toggleVolume() {
        player.muted = !player.muted
        $("#volumeIcon").toggleClass("fa-volume-up").toggleClass("fa-volume-mute");
    }

</script>